###############################################################################
# Rare-variant burden portability (plumbing test) â€” chr22 SAIGE WES(OQFE)
###############################################################################

# --- DNAnexus project where YOU write outputs ---
DX_PROJECT_ID="project-J54g2B8J7pY7bBf9kqjyQFKy"

# --- Source project that contains the OQFE files ---
SRC_PROJ="WGS v2"

# --- Chromosome for plumbing test ---
CHR="22"

# --- Where to write outputs in your current project ---
DEST_INPUTS="/inputs/rv_portability/saige_chr22_plumbing"
DEST_SAIGE="/saige/chr22_test"

# --- Where to persist small pipeline state/log artifacts in DNAnexus ---
DEST_PERSIST="/persist/rv_portability/saige_chr22_plumbing"
DX_LOG_DIR="/persist/logs/rv_portability/saige_chr22_plumbing"

# --- Local temp on the compute instance (ephemeral) ---
TMP_BASE="/opt/notebooks/work/tmp/rvp_saige_chr22"

# --- SAIGE app names (as installed on RAP) ---
APP_SPARSE_GRM="saige_gwas_sparse_grm"
APP_NULL_MODEL="saige_gwas_grm"
APP_GBAT="saige_gwas_gbat"

# --- Instance types (adjust as needed) ---
# IMPORTANT: sparse GRM can be memory-hungry. Use a larger instance.
SPARSE_INSTANCE_TYPE="mem1_hdd1_v2_x72"
NULL_INSTANCE_TYPE="mem1_hdd1_v2_x16"
GBAT_INSTANCE_TYPE="mem1_hdd1_v2_x16"

# --- TEST MODE flags (no local plink2 downsample; kept for future scaling knobs) ---
TEST_MODE=1
TEST_N_INDIV=50000
TEST_N_VARIANTS=5000

# --- Sparse GRM params (reduce these for test runs) ---
NUM_RANDOM_MARKER=200
RELATEDNESS_CUTOFF=0.125

# --- Null model plumbing ---
TRAIT_TYPE="quantitative"      # dummy phenotype => quantitative
PHENO_COL="pheno"
SAMPLE_ID_COL="IID"
COVARIATES="sex"
INVERSE_NORMALIZE=false

# --- Step2 (GBAT) plumbing ---
RUN_GBAT=0
MAX_MAF_FOR_GROUP_TEST=0.01
TEST_RANGE_START=1
TEST_RANGE_END=5000000

# If RUN_GBAT=1 you must set GROUP_TXT_ID (recommended) OR a pattern to search.
GROUP_TXT_ID=""
GROUP_FILE_PATTERN="*group*chr22*"
